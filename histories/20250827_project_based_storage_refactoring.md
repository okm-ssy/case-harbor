# プロジェクトベースのストレージリファクタリング

## 実装方針
テストケースごとに個別のJSONファイルを作成していた構造を、プロジェクトごとに1つのJSONファイルにまとめる実装に変更。ファイルI/Oを削減しパフォーマンスを向上。

## 実装内容

### 1. 新しいストレージ実装 (projectFileStorage.ts)
- プロジェクトごとにテストケースをまとめた構造を実装
- `storage/test-cases/[project-id].json` 形式でファイル保存
- `storage/projects.json` でプロジェクトインデックスを管理
- アトミックな更新のため一時ファイル経由で書き込み

### 2. ストレージアダプター (storageAdapter.ts)
- 新旧両方のストレージ形式に対応
- `STORAGE_MODE` 環境変数で切り替え可能
- 後方互換性を維持

### 3. マイグレーションスクリプト (migrate.ts)
- 既存データを新形式に変換
- バックアップを自動作成
- `ch migrate` コマンドで実行可能

### 4. データ構造
- projects.json: プロジェクトメタデータとインデックス
- test-cases/[project-id].json: プロジェクトごとのテストケース

## 効果
- ファイルアクセス数の大幅削減
- プロジェクト一覧取得: O(n) → O(1)
- テストケース一覧取得: O(n) → O(p) (p=プロジェクト数)